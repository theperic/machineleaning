---
title: "Machine Learning Assignment 1"
author: "Eric Larsen"
date: "Friday, January 23, 2015"
output: html_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
    options(warn=-1)
    library(ggplot2)
    library(plyr)
    library(rattle)
    library(caret)
##    library(mboost)
    options(warn=0)
    
    setwd("C:/Users/elarsen/Coursera work")

    train_data<-read.csv("machine learning/MachLearnAssignment/pml-training.csv")
##    test_data<-read.csv("machine learning/MachLearnAssignment/pml-testing.csv")
    dim(train_data)
    train_data<-train_data[ , ! apply( train_data , 2 , function(x) any(is.na(x)) ) ]
    dim(train_data)

    
```

```{r}
## Create training set split
    inTrain<-createDataPartition(y=train_data$classe, p=.75, list=FALSE)
    training<-train_data[inTrain,]
    testing<-train_data[-inTrain,]


```

```{r}
    forest<-train(classe ~., data=training[,2:len_data], method="rf", prox=TRUE)

```

```{r}
    pred<-predict(forest,testing[,2:len_data])
    testing$predRight<-pred==testing$classe
    table(pred,testing$classe)

```




```{r}
##Generate series of pairs plots for readabilty.
i<-1
    for(i in seq(from=1, to=(dim(training)[2]-3), by=10)){

        ##
    
    print(c("Start", i, "end",i+9))
##    x<-featurePlot(x=training[,i:(i+9)], y=factor(training$classe), plot="pairs")
 ##   print(x)
    }

```

```{r}
    
    set.seed(4150)
    factorSet<-c(78,113,116,121,123,131,134,136,139,145,160)
    x<-featurePlot(x=training[,factorSet[1:10]], y=factor(training$classe), plot="pairs")
    print(x)
##    modelFit<-train(classe ~., data=training[,factorSet], method="rpart")
    modelFit<-train(classe ~., data=training[,8:160], method="rpart")
    fancyRpartPlot(modelFit$finalModel)



##    modelFit<-train(classe ~., data=training, method="rpart")
    ##modelFit

```

#Expected Error rate
```{r}
```
